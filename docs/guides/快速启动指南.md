# Text2SQL-MCP å¿«é€Ÿå¯åŠ¨æŒ‡å—

> **ä¸€é”®å¯åŠ¨ä½ çš„AIæ•°æ®åº“åŠ©æ‰‹** ğŸš€  
> ä»0åˆ°å¯ç”¨ï¼Œåªéœ€è¦15åˆ†é’Ÿï¼

---

## ğŸƒâ€â™‚ï¸ å¿«é€Ÿå¯åŠ¨ (15åˆ†é’Ÿ)

### ç¬¬ä¸€æ­¥ï¼šä¿®å¤æ„å»ºå·¥å…· (5åˆ†é’Ÿ)

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/zhouxinping/IdeaProjects/practise/springAI-MCP

# ä¸‹è½½gradle wrapper
curl -L -o gradle/wrapper/gradle-wrapper.jar \
  https://github.com/gradle/gradle/raw/v8.5.0/gradle/wrapper/gradle-wrapper.jar

# è®¾ç½®æ‰§è¡Œæƒé™
chmod +x gradlew
```

### ç¬¬äºŒæ­¥ï¼šè®¾ç½®Javaç¯å¢ƒ (2åˆ†é’Ÿ)

```bash
# è®¾ç½®Java 24ç¯å¢ƒ
export JAVA_HOME=/Library/Java/JavaVirtualMachines/zulu-24.jdk/Contents/Home
export PATH=$JAVA_HOME/bin:$PATH

# éªŒè¯Javaç‰ˆæœ¬
java -version
```

**é¢„æœŸè¾“å‡º**:
```
openjdk version "24.0.2" 2025-07-15
OpenJDK Runtime Environment Zulu24.32+13-CA (build 24.0.2+12)
OpenJDK 64-Bit Server VM Zulu24.32+13-CA (build 24.0.2+12, mixed mode, sharing)
```

### ç¬¬ä¸‰æ­¥ï¼šæ„å»ºé¡¹ç›® (5åˆ†é’Ÿ)

```bash
# æ¸…ç†å’Œæ„å»ºé¡¹ç›®
./gradlew clean build -x test

# å¦‚æœæ„å»ºæˆåŠŸï¼Œä¼šçœ‹åˆ°ï¼š
# BUILD SUCCESSFUL in 2m 15s
```

### ç¬¬å››æ­¥ï¼šå¯åŠ¨åº”ç”¨ (3åˆ†é’Ÿ)

```bash
# å¯åŠ¨Spring Bootåº”ç”¨
./gradlew bootRun

# æˆ–è€…ä½¿ç”¨start.shè„šæœ¬
# ./start.sh
```

**å¯åŠ¨æˆåŠŸæ ‡å¿—**:
```
2025-01-15 10:30:15.123  INFO 12345 --- [           main] c.k.s.m.SpringAiMcpApplication           : Started SpringAiMcpApplication in 8.456 seconds (JVM running for 9.123)
2025-01-15 10:30:15.124  INFO 12345 --- [           main] c.k.s.m.config.Text2SqlMcpServerConfig   : Text2SQL MCPæœåŠ¡å™¨é…ç½®å®Œæˆ
2025-01-15 10:30:15.125  INFO 12345 --- [           main] c.k.s.m.cache.SchemaCache                : æ•°æ®åº“ç»“æ„ç¼“å­˜å·²å¯ç”¨ - æœ¬åœ°ç¼“å­˜TTL: 3600ç§’
```

---

## âœ… åŠŸèƒ½éªŒè¯ (5åˆ†é’Ÿ)

### åŸºç¡€å¥åº·æ£€æŸ¥
```bash
curl http://localhost:8080/api/health
```

**é¢„æœŸå“åº”**:
```json
{
  "status": "UP",
  "service": "Text2SQL MCP Server", 
  "version": "1.0.0",
  "timestamp": 1705314615123
}
```

### MCPæœåŠ¡å™¨çŠ¶æ€
```bash
curl http://localhost:8080/api/health/mcp
```

### ç¼“å­˜ç³»ç»ŸçŠ¶æ€
```bash
curl http://localhost:8080/api/health/cache
```

### Text2SQLåŠŸèƒ½æµ‹è¯•
```bash
curl http://localhost:8080/api/health/test-text2sql
```

---

## ğŸ—„ï¸ æ•°æ®åº“é…ç½® (å¯é€‰)

å¦‚æœä½ æœ‰MySQLæ•°æ®åº“ï¼Œå¯ä»¥é…ç½®è¿æ¥ï¼š

### é…ç½®æ•°æ®åº“è¿æ¥

ç¼–è¾‘ `src/main/resources/application.yml`:

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/your_database
    username: your_username
    password: your_password
```

æˆ–è€…è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
export MYSQL_HOST=localhost
export MYSQL_PORT=3306
export MYSQL_DATABASE=testdb
export MYSQL_USERNAME=root
export MYSQL_PASSWORD=yourpassword
```

### æµ‹è¯•æ•°æ®åº“è¿æ¥

```bash
curl http://localhost:8080/api/health/mcp
```

---

## ğŸ§ª APIæ¥å£æµ‹è¯•

### 1. æ•°æ®åº“ç»“æ„æŸ¥è¯¢

```bash
curl -X POST http://localhost:8080/api/mcp/text2sql/describe-database
```

### 2. è‡ªç„¶è¯­è¨€è½¬SQL

```bash
curl -X POST http://localhost:8080/api/mcp/text2sql/text-to-sql \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "query=æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯"
```

### 3. SQLè§£é‡Š

```bash
curl -X POST http://localhost:8080/api/mcp/text2sql/explain-sql \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "sql=SELECT * FROM users WHERE age > 18"
```

### 4. SQLæ‰§è¡Œï¼ˆéœ€è¦æ•°æ®åº“è¿æ¥ï¼‰

```bash
curl -X POST http://localhost:8080/api/mcp/text2sql/execute-query \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "sql=SELECT COUNT(*) as total FROM information_schema.tables"
```

---

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### Q1: Gradle wrapperä¸‹è½½å¤±è´¥
```bash
# æ‰‹åŠ¨ä¸‹è½½gradle wrapper
wget https://github.com/gradle/gradle/raw/v8.5.0/gradle/wrapper/gradle-wrapper.jar \
  -O gradle/wrapper/gradle-wrapper.jar
```

### Q2: Javaç‰ˆæœ¬ä¸å¯¹
```bash
# æ£€æŸ¥å¯ç”¨çš„Javaç‰ˆæœ¬
ls /Library/Java/JavaVirtualMachines/

# å¦‚æœæ²¡æœ‰Java 24ï¼Œå¯ä»¥ä¸´æ—¶ä½¿ç”¨Java 17
export JAVA_HOME=/Library/Java/JavaVirtualMachines/zulu-17.jdk/Contents/Home
```

### Q3: ç«¯å£å†²çª
ä¿®æ”¹ `application.yml` ä¸­çš„ç«¯å£ï¼š
```yaml
server:
  port: 8081  # æ”¹ä¸ºå…¶ä»–å¯ç”¨ç«¯å£
```

### Q4: MySQLè¿æ¥å¤±è´¥
```bash
# è·³è¿‡æ•°æ®åº“è¿æ¥ï¼Œåªä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
export SPRING_PROFILES_ACTIVE=mock
./gradlew bootRun
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥æ“ä½œ

### å¼€å‘ç¯å¢ƒè®¾ç½®
1. **IDEå¯¼å…¥**: åœ¨IntelliJ IDEAæˆ–VS Codeä¸­å¯¼å…¥é¡¹ç›®
2. **æ•°æ®åº“å‡†å¤‡**: åˆ›å»ºæµ‹è¯•MySQLæ•°æ®åº“
3. **AIæ¨¡å‹é…ç½®**: è®¾ç½®OpenAI API Keyç”¨äºText2SQLåŠŸèƒ½

### åŠŸèƒ½æ‰©å±•
1. **æ·»åŠ æ›´å¤šæ•°æ®åº“æ”¯æŒ**: PostgreSQL, SQL Serverç­‰
2. **å¢å¼ºå®‰å…¨åŠŸèƒ½**: OAuthè®¤è¯ã€ç”¨æˆ·æƒé™ç®¡ç†  
3. **æ€§èƒ½ä¼˜åŒ–**: Redisç¼“å­˜ã€æŸ¥è¯¢ä¼˜åŒ–

### ç”Ÿäº§éƒ¨ç½²
1. **DockeråŒ–**: å®¹å™¨åŒ–éƒ¨ç½²
2. **ç›‘æ§å‘Šè­¦**: æ·»åŠ Prometheus + Grafanaç›‘æ§
3. **è´Ÿè½½å‡è¡¡**: Nginxåå‘ä»£ç†é…ç½®

---

## ğŸ“ è·å–å¸®åŠ©

**æŸ¥çœ‹æ—¥å¿—**:
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f logs/spring.log

# æˆ–è€…å¯åŠ¨æ—¶ç›´æ¥æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º
./gradlew bootRun --info
```

**è°ƒè¯•æ¨¡å¼**:
```bash
# å¯ç”¨è°ƒè¯•æ—¥å¿—
./gradlew bootRun --args='--logging.level.com.kami=DEBUG'
```

**é¡¹ç›®æ–‡æ¡£**:
- [é¡¹ç›®è¿›åº¦æŠ¥å‘Š.md](./é¡¹ç›®è¿›åº¦æŠ¥å‘Š.md) - è¯¦ç»†è¿›åº¦å’ŒæŠ€æœ¯åˆ†æ
- [Text2SQL-MCPè®¾è®¡æ–¹æ¡ˆ.md](./Text2SQL-MCPè®¾è®¡æ–¹æ¡ˆ.md) - å®Œæ•´è®¾è®¡æ–¹æ¡ˆ

---

*ğŸ‰ æ­å–œï¼ä½ ç°åœ¨æ‹¥æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„AIé©±åŠ¨çš„Text2SQLç³»ç»Ÿï¼*